---
layout  : wiki
title   : Subnetting & Supernetting
summary :
date    : 2022-02-05 13:30:00 +0900
updated : 2022-02-05 13:30:00 +0900
tags     : network
toc     : true
public  : true
parent  : [[how-to]]
latex   : true
---
* TOC
{:toc}

# Subnetting 
## 개념
우리가 사용하는 모든 IP들을 한 네트워크에 사용하기엔 너무나 큰 낭비라고 볼 수 있다.

그렇기 때문에 이 낭비들을 줄이고자 Network ID와 Host ID를 구분하여 효율성을 증대화한 것이 Subnet Mask.

### Subnet Mask

![image](https://user-images.githubusercontent.com/60500649/152643615-22da8dd8-3b24-47a4-9ebf-f57d255bc7ea.png)

### Subnetting 이란 ?

IP 주소에 *Default Subnet Mask 가 아닌 변형된 Subnet Mask를 적용함으로써 네트워크를 여러개로 분할하고 불필요한 네트워크 자원낭비를 막는 것이다.

* Default Subnet Mask

A Class : 255.0.0.0

B Class : 255.255.0.0

C Class : 255.255.255.0



### 첫 번째 가정

만약 관리하고 있는 건물에서 172.16.0.0/16 의 대역대가 주어졌다고 가정해보자.

각 층마다 IP를 사용하는 Device가 최대 240대 정도가 들어오게 된다고 보았을 때 우리는 모든 층에 172.16.0.0/16 의 대역으로 IP를 뿌려 관리를 하게 된다면 장애가 나서 IP를 확인하여도 그 자리가 어디인지 제대로 파악이 안 될 것이다..

좀 더 효율적인 관리를 위해서 Subnetting이 필요한 것.


< Subnetting >

172.16.0.0/16

1010 1100 . 0000 1000 . 0000 0000 . 0000 0000

/ 1111 1111 . 1111 1111 . 0000 0000 . 0000 0000

위 주어진 대역에서 우리가 사용하는 Host 가 최대 240대라고 보면, Host ID부분을 2의승으로 최소값을 구해야한다.

2, 4, 8, 16, 32, 64, 128, 256.. 2의 8승인 256이 된다.


기존 대역대의 뒷 자리부터 순서대로 8번째까지 Host ID로 사용하게 되고 나머지는 네트워크 ID로 변형이 된 것이다.

1010 1100 . 0000 1000 . 0000 0000 . 0000 0000

/ 1111 1111 . 1111 1111 . 1111 1111 . 0000 0000

172.16.0.0/24 로 최종 변형이 된 것.

그렇게해서 사용할 수 있는 대역은 172.16.0.0/24 ~ 172.16.255.0/24 까지로 볼 수 있다.

## 예시

### 문제

#### 1. 192.168.0.0/24의 대역에서 4개의 Network 대역으로 분할을 하라.

#### 2. 192.168.0.0/24의 대역에서 각각 13대의 Device를 사용할 수 있게 분할하라.

### 풀이

#### < 1 >

192.168.0.0/24

1100 0000 . 1010 1000. 0000 0000 . 0000 0000

/ 1111 1111 . 1111 1111 . 1111 1111 . 0000 0000

-> 1100 0000 . 1010 1000 . 0000 0000 . 0000 0000

주어진 대역이 prefix 24의 값을 가지기 때문에 빨간 숫자에서 네트워크 대역을 각각 00, 01, 10, 11 .. 총 4개로 나눌 수 있다.

답 : 192.168.0.0/26

#### < 2 >

192.168.0.0/24

1100 0000 . 1010 1000. 0000 0000 . 0000 0000

/ 1111 1111 . 1111 1111 . 1111 1111 . 0000 0000

-> 1100 0000 . 1010 1000 . 0000 0000 . 0000 0000

이번엔 Host ID를 기준으로 변형해주는 것이 중요하다. 빨간 숫자의 총 변수는 16개, 13을 위한 최솟값이다.

그러므로 빨간 숫자의 앞 부분까지 Network ID로 변형이 되는 것

답 : 192.168.0.0/28

# Supernetting

## 개념
### 슈퍼넷팅 ( Supernetting ) 이란 ?

전 시간에 다루었던 Subnetting의 개념과는 반대로 여러개의 작은 Network를 하나의 커다란 Network로 바꾸는 작업을 의미한다.

- 이 과정에서 우리는 축약 ( Summarization )이라는 표현을 사용 할 수 있다.

### 슈퍼넷팅의 목적은 다음과 같다.

1. 여러 네트워크의 공통되는 부분을 정리하여 하나의 네트워크로 묶는 것

2. 여러 Route를 하나의 Route로 요약하는 것 ( Summarization )

    - 네트워크 정보를 요약하여 라우팅 테이블에서 다루어야할 정보량을 줄여 메모리, CPU등의 자원 낭비를 막기위함

3. Network Topology의 급격한 변화의 격리가 가능케 됨.

    - Router들이 Flapping상태여도 Summarization되어진 경로는 변하지 않는다.



### 첫 번째 가정

관리하는 건물의 네트워크는 각각 10.0.1.0/24, 10.0.20.0/24, 10.0.120.0/으로 나누어져 있다.

최상단의 라우터에서 해당하는 경로들을 축약하여 보내고자 할 때 어떠한 Network Address가 입력되어야 하는가 ?

< Supernetting >

10.0.1.0/24, 10.0.20.0/24, 10.0.120.0/24

위 대역대를 모두 포함하는 주소를 찾아야 하기 때문에 핵심을 짚어보자면,

10.0.1.0 ~ 10.0.120.0, 3옥텟에서 1 ~ 120을 한꺼번에 포함할 수 있어야만 한다.

현재 prefix 24의 값을 가진 현재의 SubnetMask의 자릿수를 하나하나 내려보자.

->  prefix 23, 255.255.254.0,  3옥텟에서는 128개가 분리됨

     prefix 22, 255.255.252.0,  3옥텟에서는 64개가 분리됨

     prefix 21, 255.255.248.0,  3옥텟에서는 32개가 분리됨

     prefix 20, 255.255.240.0,  3옥텟에서는 16개가 분리됨

     prefix 19, 255.255.224.0,  3옥텟에서는 8개가 분리됨

     prefix 18, 255.255.192.0,  3옥텟에서는 4개가 분리됨

     prefix 17, 255.255.128.0,  3옥텟에서는 2개가 분리됨



prefix 17에서는 255.255.128.0의 SubnetMask를 가지게 되어서 0 부터 128을 가지는 대역이 되었다.

그렇게해서 최상단의 라우터에서 입력하고자 하는 주소는 10.0.0.0/17 을 입력 할 수 있으며,

10.0.0.0/17 ~ 10.0.128.0/17 에 포함하는 모든 대역을 바라보게 된다.

## 예시
다음은 CCNA에 출제되었던 Supernetting 관련 문제를 통해서 다져보자.

### Question

Refer to the exhibit. What is the most appropriate summarizaion for these routes?

![image](https://user-images.githubusercontent.com/60500649/152643627-5d4bf079-d47c-4f29-b66a-ad907a896523.png)

A. 10.0.0.0 /21

B. 10.0.0.0 /22

C. 10.0.0.0 /23

D. 10.0.0.0 /24

### Answer

다음의 그림을 참조해서  포함하고 있는 Network 대역대를 위한 가장 적당한 축약방법을 고르라고 한다.

각각의 서브넷을 해석해 보면 다음과 같은 결과가 나온다.

A. 10.0.0.0 /21  ->  10.0.0.0 / 255.255.248.0 = 10.0.0.0 ~ 10.0.7.255

**B. 10.0.0.0 /22  ->  10.0.0.0 / 255.255.252.0 = 10.0.0.0 ~ 10.0.3.255**

C. 10.0.0.0 /23  ->  10.0.0.0 / 255.255.254.0 = 10.0.0.0 ~ 10.0.1.255

D. 10.0.0.0 /24  ->  10.0.0.0 / 255.255.255.0 = 10.0.0.0 ~ 10.0.0.255

해석된 B의 내용을 보면 10.0.0.0 ~ 10.0.3.0 의 대역을 모두 포함하는 것을 알 수 있다.

정답 : B
